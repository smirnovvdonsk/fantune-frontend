import{_ as a,F as d,a as h,r as f,o as m,c as p,b as v,d as c,w as y,v as w,t as C,e as O}from"./vendor.956c8d1f.js";const g=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const t of n)if(t.type==="childList")for(const r of t.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function i(n){const t={};return n.integrity&&(t.integrity=n.integrity),n.referrerpolicy&&(t.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?t.credentials="include":n.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function o(n){if(n.ep)return;n.ep=!0;const t=i(n);fetch(n.href,t)}};g();const b="ws://31.134.181.226:58000/websocket",I="FanTune";var l={ROOT:b,TITLE:I};class T{constructor(e="",i=()=>{}){this.url=e,this.onmessage=i,this.init()}init(){try{this.wsConnection.close()}catch{}this.wsConnection=new WebSocket(this.url),this.wsConnection.onopen=()=>{document.dispatchEvent(new CustomEvent("connected")),console.info("\u0421\u043E\u0435\u0434\u0438\u043D\u0435\u043D\u0438\u0435 \u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u043E.")},this.wsConnection.onmessage=e=>this.onmessage(e.data),this.wsConnection.onclose=e=>{document.dispatchEvent(new CustomEvent("disconnected")),e.wasClean?console.info("\u0421\u043E\u0435\u0434\u0438\u043D\u0435\u043D\u0438\u0435 \u0437\u0430\u043A\u0440\u044B\u0442\u043E \u0447\u0438\u0441\u0442\u043E"):console.warn("\u041E\u0431\u0440\u044B\u0432 \u0441\u043E\u0435\u0434\u0438\u043D\u0435\u043D\u0438\u044F"),setTimeout(()=>this.init(),6e3)},this.wsConnection.onerror=()=>{document.dispatchEvent(new CustomEvent("disconnected"))}}send(e){switch(typeof e){case"object":e=JSON.stringify(e);break;case"number":e=e.toString();break}this.wsConnection.readyState?this.wsConnection.send(e):setTimeout(()=>this.send(e),500)}}var u="./index.assets/favicon.8fb32861.svg";const E={data(){return{query:new d,result:{},searching:!1,notFound:!1,connection:{},connected:!1,online:!1,numberOfClients:null,onInputTimer:null}},computed:{favicon(){return u},visitorsInfo(){return`\u042D\u0442\u0443 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0443 \u0441\u0435\u0439\u0447\u0430\u0441 \u0441\u043C\u043E\u0442\u0440${this.numberOfClients>1?"\u044F\u0442":"\u0438\u0442"}
          ${this.numberOfClients>0?this.numberOfClients:""}
          ${this.numberOfClients>0?"\u0447\u0435\u043B\u043E\u0432\u0435\u043A":"\u043D\u0438\u043A\u0442\u043E"}${this.numberOfClients>=2&&this.numberOfClients<=4?"\u0430":""}`}},methods:{setFavicon(s){let e=document.head.querySelector("link[rel~='icon']");e||(e=document.createElement("link"),e.rel="icon",document.head.appendChild(e)),e.href=s},setTitle(s){let e=document.head.querySelector("title");e||(e=document.createElement("title"),document.head.appendChild(e)),e.innerHTML=s},wsInit(){this.connection=new T(l.ROOT,this.wsHandler),document.addEventListener("connected",s=>{this.connected=!0,this.queryIsOnline()}),document.addEventListener("online",s=>{this.online=!0,this.onInput()}),document.addEventListener("disconnected",s=>{this.connected=!1,this.result={},this.numberOfClients=null}),document.addEventListener("offline",s=>{this.online=!1,this.result={}}),this.queryIsOnline(),setInterval(()=>this.queryIsOnline(),6e5)},wsHandler(s){let e=s;try{e=JSON.parse(s)}catch{}if(e.event==="online"&&(e.content?document.dispatchEvent(new CustomEvent("online")):document.dispatchEvent(new CustomEvent("offline"))),e.event==="numberOfClients"&&(e.content?this.numberOfClients=e.content:this.numberOfClients=null),e.event==="vent"){let i=e.content,o=e.query,n=()=>{this.result={},this.searching=!1,this.notFound=!0,this.onInput()};if(i&&o)try{JSON.stringify(this.query.export)===JSON.stringify(o)?(JSON.stringify(this.result)!==JSON.stringify(i)&&(this.result=i),this.notFound=this.searching=!1):console.info("\u041E\u0447\u0435\u0440\u0435\u0434\u043D\u043E\u0439 \u043E\u0442\u0432\u0435\u0442 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u043F\u0440\u043E\u0438\u0433\u043D\u043E\u0440\u0438\u0440\u043E\u0432\u0430\u043D \u043A\u0430\u043A \u0443\u0441\u0442\u0430\u0440\u0435\u0432\u0448\u0438\u0439")}catch{n()}else n()}},queryIsOnline(){this.connected&&this.connection.send({event:"online"})},queryVent(){this.connected&&this.connection.send({event:"vent",content:this.query.export})},onInput(){this.onInputTimer&&(clearTimeout(this.onInputTimer),this.onInputTimer=null),this.searching=!0,this.notFound=!1,this.result={},this.onInputTimer=setTimeout(()=>{this.queryVent()},100)}},mounted(){this.setTitle(l.TITLE),this.setFavicon(u),setTimeout(()=>this.wsInit(),500)},components:{FanTune:h}},q={class:"navbar navbar-expand navbar-dark bg-dark text-light shadow d-flex flex-column flex-xl-row justify-content-between px-3"};function F(s,e,i,o,n,t){const r=f("FanTune");return m(),p("div",null,[v(r,{query:n.query,result:n.result,searching:n.searching,notFound:n.notFound,connected:n.connected,online:n.online,onChangeInputParams:t.onInput},null,8,["query","result","searching","notFound","connected","online","onChangeInputParams"]),c("footer",q,[y(c("div",null,C(t.visitorsInfo),513),[[w,n.connected]])])])}var S=a(E,[["render",F]]);O(S).mount("#app");
